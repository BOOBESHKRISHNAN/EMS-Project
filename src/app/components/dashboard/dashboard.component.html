<div class="dashboard-container">
  <!-- Header Section -->
  <div class="dashboard-header">
    <div class="welcome-section">
      <h1>{{ getWelcomeMessage() }}</h1>
      <p class="current-date">{{ currentDate | date:'fullDate' }}</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-outline" (click)="logout()">
        <i class="fas fa-sign-out-alt"></i> Logout
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Loading dashboard...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-container">
    <div class="alert alert-error">
      <i class="fas fa-exclamation-triangle"></i>
      {{ error }}
    </div>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!loading" class="dashboard-content">
    
    <!-- Quick Actions Section -->
    <div class="quick-actions-section">
      <h2>Quick Actions</h2>
      <div class="action-cards">
        
        <!-- View Events Action -->
        <div class="action-card" (click)="navigateToEvents()">
          <div class="card-icon">
            <i class="fas fa-calendar-alt"></i>
          </div>
          <div class="card-content">
            <h3>Browse Events</h3>
            <p>Discover upcoming events</p>
          </div>
        </div>

        <!-- Create Event Action (for authorized roles) -->
        <div *ngIf="canCreateEvents()" class="action-card" (click)="navigateToCreateEvent()">
          <div class="card-icon">
            <i class="fas fa-plus-circle"></i>
          </div>
          <div class="card-content">
            <h3>Create Event</h3>
            <p>Organize a new event</p>
          </div>
        </div>

        <!-- My Tickets Action (for registered users) -->
        <div *ngIf="canViewTickets()" class="action-card" (click)="navigateToMyTickets()">
          <div class="card-icon">
            <i class="fas fa-ticket-alt"></i>
          </div>
          <div class="card-content">
            <h3>My Tickets</h3>
            <p>View your booked tickets</p>
          </div>
        </div>

        <!-- Manage Locations Action (for super admin) -->
        <div *ngIf="canManageLocations()" class="action-card" (click)="navigateToLocations()">
          <div class="card-icon">
            <i class="fas fa-map-marker-alt"></i>
          </div>
          <div class="card-content">
            <h3>Manage Locations</h3>
            <p>Add and edit venues</p>
          </div>
        </div>

      </div>
    </div>

    <!-- Dashboard Widgets -->
    <div class="dashboard-widgets">
      
      <!-- Recent Events Widget -->
      <div class="widget">
        <div class="widget-header">
          <h3><i class="fas fa-calendar"></i> Recent Events</h3>
          <button class="btn btn-sm btn-link" (click)="navigateToEvents()">View All</button>
        </div>
        <div class="widget-content">
          <div *ngIf="events.length === 0" class="no-data">
            <i class="fas fa-calendar-times"></i>
            <p>No events available</p>
          </div>
          <div *ngFor="let event of events" class="event-item" (click)="viewEventDetails(event.id)">
            <div class="event-info">
              <h4>{{ event.title }}</h4>
              <p class="event-date">
                <i class="fas fa-clock"></i>
                {{ formatDate(event.startDate) }}
              </p>
              <p class="event-location">
                <i class="fas fa-map-marker-alt"></i>
                {{ event.location.name }}
              </p>
            </div>
            <div class="event-organizer">
              <small>by {{ event.organizerName }}</small>
            </div>
          </div>
        </div>
      </div>

      <!-- My Tickets Widget (for registered users) -->
      <div *ngIf="canViewTickets()" class="widget">
        <div class="widget-header">
          <h3><i class="fas fa-ticket-alt"></i> My Recent Tickets</h3>
          <button class="btn btn-sm btn-link" (click)="navigateToMyTickets()">View All</button>
        </div>
        <div class="widget-content">
          <div *ngIf="myTickets.length === 0" class="no-data">
            <i class="fas fa-ticket-alt"></i>
            <p>No tickets booked yet</p>
          </div>
          <div *ngFor="let ticket of myTickets" class="ticket-item">
            <div class="ticket-info">
              <h4>{{ ticket.eventTitle }}</h4>
              <p class="ticket-date">
                <i class="fas fa-calendar"></i>
                {{ formatDate(ticket.eventDate) }}
              </p>
              <div class="ticket-status" [ngClass]="'status-' + ticket.status.toLowerCase()">
                {{ ticket.status }}
              </div>
            </div>
            <div class="ticket-details">
              <span class="ticket-price">${{ ticket.ticketPrice }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Locations Widget (for super admin) -->
      <div *ngIf="canManageLocations()" class="widget">
        <div class="widget-header">
          <h3><i class="fas fa-map-marker-alt"></i> Locations Overview</h3>
          <button class="btn btn-sm btn-link" (click)="navigateToLocations()">Manage All</button>
        </div>
        <div class="widget-content">
          <div *ngIf="locations.length === 0" class="no-data">
            <i class="fas fa-map-marker-alt"></i>
            <p>No locations available</p>
          </div>
          <div *ngFor="let location of locations" class="location-item">
            <div class="location-info">
              <h4>{{ location.name }}</h4>
              <p class="location-address">
                <i class="fas fa-map-pin"></i>
                {{ location.address }}, {{ location.city }}, {{ location.state }}
              </p>
              <p class="location-events">
                <i class="fas fa-calendar"></i>
                {{ location.events.length }} events
              </p>
            </div>
            <div class="location-fee">
              <span class="venue-fee">${{ location.venueFee }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Statistics Widget (for admin roles) -->
      <div *ngIf="canCreateEvents()" class="widget">
        <div class="widget-header">
          <h3><i class="fas fa-chart-bar"></i> Quick Stats</h3>
        </div>
        <div class="widget-content">
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-number">{{ events.length }}</div>
              <div class="stat-label">Recent Events</div>
            </div>
            <div *ngIf="canManageLocations()" class="stat-item">
              <div class="stat-number">{{ locations.length }}</div>
              <div class="stat-label">Locations</div>
            </div>
            <div *ngIf="canViewTickets()" class="stat-item">
              <div class="stat-number">{{ myTickets.length }}</div>
              <div class="stat-label">My Tickets</div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>